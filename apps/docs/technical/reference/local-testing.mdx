---
title: "Develop ComfyUI Pipelines in Dev Container"
description: "This guide is intended for developers who are looking to develop custom nodes for ComfyUI"
icon: "code"
---
# Quick Start Guide

This guide will cover how to easily setup a remote ComfyUI development environment for use with ComfyStream as a real-time video developer

System pre-requisites:
- [ComfyStream](https://github.com/yondonfu/comfystream) is a tool for running live streams through ComfyUI, created by Yondon. Here is a guide for setting it up on RunPod. 
- Docker builder and Docker compose
- Node.js (for UI)

# Step 1: Set up Docker Dev Container
1. Clone ComfyUI-Builder and compile the base dev container
```bash
git clone https://github.com/eliteprox/comfyui-builder
cd comfyui-builder/.devcontainer
docker build -f Dockerfile.base -t comfyui-builder:base-latest .
```
2. Create local folders to store the custom nodes and models used by ComfyUI 
```bash
mkdir -p $HOME/ComfyUI--models
mkdir -p $HOME/ComfyUI--nodes
```
2. From VS Code, open the `comfyui-builder` folder in a devcontainer using the [Remote-Containers extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers):
    - Press `Ctrl+Shift+P` to open the Command Palette.
    - Type and select `Remote-Containers: Reopen in Container`.
    <Note>Verify the volume mount paths are correct in `.devcontainer/devcontainer.json` Defaults are `$HOME/ComfyUI--models` and `$HOME/ComfyUI--nodes`</Note>
3. From inside the running dev container, install ComfyUI Custom Nodes: 
```bash
chmod 777 install-nodes.sh
./install-nodes.sh
```
4. Build the TensorRT engines:
```bash
chmod 777 build-tensorrt.sh
./build-tensorrt.sh
```

# Step 2: Run ComfyUI
1. From the devcontainer, run the following:
```bash
cd /ComfyUI
python main.py --listen
```
You should see startup logs like:
```
Import times for custom nodes:
   0.0 seconds (IMPORT FAILED): /ComfyUI/custom_nodes/tensor_utils
   0.0 seconds: /ComfyUI/custom_nodes/ComfyUI-Misc-Effects
   0.0 seconds: /ComfyUI/custom_nodes/ComfyUI-Manager
   0.1 seconds: /ComfyUI/custom_nodes/ComfyUI-SAM2-Realtime
   0.3 seconds (IMPORT FAILED): /ComfyUI/custom_nodes/ComfyUI-Depth-Anything-Tensorrt
   0.5 seconds: /ComfyUI/custom_nodes/ComfyUI_RyanOnTheInside
```
<Note>
It is normal for the tensorrt nodes to fail to import, as they are not compatible with ComfyUI alone and are used only by ComfyStream
</Note>

2. You should be able to access the ComfyUI web interface at http://localhost:8188
<Note>
If you are running the devcontainer on a remote server, you can access the web interface by setting up an SSH tunnel to the remote server and forwarding the port to your local machine.
You can also set the interface with `--host`
</Note>

# Step 3: Run ComfyStream

1. From the devcontainer, activate the `comfystream` conda environment:
```bash
conda activate comfystream
cd /comfystream
```
2. Run ComfyStream
```bash
python server/app.py --workspace /ComfyUI --media-ports=5678 --host=0.0.0.0
```
The ComfyStream API should now be listening on port 8888, with media port 5678 listening on UDP. 

We will provide this endpoint to the ComfyStream UI when starting a live stream.


# Step 4: Run the Front End

Follow the guide [Run ComfyStream UI](./local-testing-comfystream-ui) to start a live stream with new development environment
